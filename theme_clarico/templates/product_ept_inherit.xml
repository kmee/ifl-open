<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--=================== Product ========================-->
    <template id="product_ept_inherit" inherit_id="theme_clarico.product_ept"
		name="product" priority="999999">

        <xpath expr="//t[@t-placeholder='select']" position="before">
            <hr/>
        </xpath>

    </template>

    <!--=================== Secondary unit ========================-->
    <template id="product_inherit" inherit_id="website_sale_secondary_unit.product"
		name="product" priority="999999">

        <xpath expr="//div[hasclass('secondary-unit')]" position="replace">
            <div class="mb8 secondary-unit row">
                <div class="col-md-3">
                    <t t-call="website_sale_secondary_unit.secondary_qty"/>
                </div>
                <div class="col-md-6">
                    <select class="form-control" id="secondary_uom" name="secondary_uom_id">
                    <option t-if="product_secondary_uom_ids_sudo and product.allow_uom_sell"
                        value="0"
                        t-att-selected="'selected' if not product.sale_secondary_uom_id else None"
                        t-att-data-secondary-uom-factor="1.0"
                        t-att-data-product-uom-factor="1.0">
                        <span t-esc="product.uom_id.sudo().name"/>
                    </option>
                    <t t-foreach="product_secondary_uom_ids_sudo" t-as="secondary_uom">
                        <option t-att-value="secondary_uom.id"
                                t-att-selected="'selected' if product.sudo().sale_secondary_uom_id.id == secondary_uom.id else None"
                                t-att-data-secondary-uom-factor="secondary_uom.factor"
                                t-att-data-product-uom-factor="product.sudo().uom_id.factor">
                            <t t-call="website_sale_secondary_unit.second_qty_description"/>
                        </option>
                    </t>
                </select>
                </div>
                <div class="col-md-3"/>
            </div>
        </xpath>

        <xpath expr="//a[@id='add_to_cart']" position="before">
            <br/>
            <h1 class="te_product_name">Composição do preço:</h1>
            <li class="" style="list-style: none !important;">
                <span class="custom_cost_price">Preço do produtor: R$
                    2,70/kg</span>
            </li>
            <li class="" style="list-style: none !important;">
                <span class="custom_contribution_price">Contribuição (35%): R$
                    2,70/kg</span>
            </li>
            <div class="product_price custom_product_price mt16" style="display: inline-flex;">
                <h4 class="oe_price_h4 css_editable_mode_hidden mt16" style="margin-right: 4px;">Subtotal:</h4>
                <t t-call="theme_clarico.product_price_inherit" />
            </div>
        </xpath>


<!--        <b data-oe-type="monetary" data-oe-expression="combination_info['price']" class="oe_price" style="white-space: nowrap;">R$&nbsp;<span class="oe_currency_value">3,95</span></b>-->

    </template>


    <!--=================== Secondary unit ========================-->
    <template id="product_variants_inherit" inherit_id="website_sale.product_variants"
		name="product" priority="999999">

        <xpath expr="//span[hasclass('badge')]" position="replace"/>

<!--        Get text between parenthesis (produtor name)-->
        <xpath expr="//label/span" position="replace">
            <t t-set="produtor_name" t-value="combination_info['display_name'][combination_info['display_name'].find('(')+1:combination_info['display_name'].find(')')]"/>
            <span t-esc="produtor_name"/>
        </xpath>

    </template>

    <!--=================== Secondary quantity ========================-->
    <template id="secondary_qty_inherit" inherit_id="website_sale_secondary_unit.secondary_qty"
		name="product" priority="999999">

        <xpath expr="//input[hasclass('secondary-quantity')]" position="replace">
            <input type="text" class="form-control secondary-quantity" data-min="1" name="add_secondary_qty" value="1" style="padding: 0 !important; text-align: center !important;"/>
        </xpath>

    </template>

    <!--=================== Product price ========================-->
    <template id="product_price_inherit" inherit_id="website_sale.product_price"
		name="custom_product" priority="999999" primary="True">

        <xpath expr="//h4" position="replace">
            <h4 class="oe_price_h4 css_editable_mode_hidden">
              <b class="oe_price" style="white-space: nowrap;" t-esc="combination_info['price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
            </h4>
        </xpath>

    </template>

</odoo>
